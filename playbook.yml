---
- name: ğŸš€ ConfiguraciÃ³n AutomÃ¡tica de Servidores
  hosts: servers
  become: yes
  tasks:

    - name: ğŸ“¦ Actualizar cachÃ© de paquetes APT
      apt:
        update_cache: yes

    - name: â¬†ï¸ Actualizar paquetes del sistema
      apt:
        upgrade: dist
        autoremove: yes

    - name: ğŸ‘¤ Crear usuario itla
      user:
        name: itla
        comment: "Usuario creado por Ansible"
        shell: /bin/bash
        create_home: yes

    - name: ğŸ“ Crear carpeta app
      file:
        path: /home/itla/app
        state: directory
        owner: itla
        group: itla
        mode: '0755'

    - name: ğŸ“ Crear archivo hola.txt
      copy:
        content: "Â¡Hola ITLA! Ansible funciona correctamente.\n"
        dest: /home/itla/app/hola.txt
        owner: itla
        group: itla
        mode: '0644'

    - name: âœ… Verificar archivo creado
      stat:
        path: /home/itla/app/hola.txt
      register: archivo_hola

    - name: ğŸ’¬ Mostrar contenido del archivo
      command: cat /home/itla/app/hola.txt
      register: contenido
      when: archivo_hola.stat.exists
      changed_when: false

    - debug:
        msg: "{{ contenido.stdout }}"
